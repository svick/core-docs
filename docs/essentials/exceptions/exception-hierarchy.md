# Exception Hierarchy

There are two types of exceptions: exceptions generated by an executing program, and exceptions generated by the common language runtime. In addition, there is a hierarchy of exceptions that can be thrown by either an application or the runtime.

[Exception](exception-class-properties.md) is the base class for exceptions. Several exception classes inherit directly from **Exception**, including **ApplicationException** and **SystemException**. These two classes form the basis for almost all runtime exceptions.

Most exceptions that derive directly from **Exception** add no functionality to the **Exception** class. For example, the [InvalidCastException](https://msdn.microsoft.com/en-us/library/system.invalidcastexception) class hierarchy is as follows:

```none
Object
  Exception
    SystemException
       InvalidCastException
```

The runtime throws the appropriate derived class of **SystemException** when errors occur. These errors result from failed runtime checks (such as array out-of-bound errors), and can occur during the execution of any method. If you are designing an application that creates new exceptions, you should derive those exceptions from the **Exception** class. It is not recommended that you catch a **SystemException**, nor is it good programming practice to throw a **SystemException** in your application.

The most severe exceptions — those thrown by the runtime or in nonrecoverable conditions — include [ExecutionEngineException](https://msdn.microsoft.com/en-us/library/system.executionengineexception), [StackOverflowException](https://msdn.microsoft.com/en-us/library/system.stackoverflowexception), and [OutOfMemoryException](https://msdn.microsoft.com/en-us/library/system.outofmemoryexception).

## Hierarchy of Runtime Exceptions

The following table hierarchically lists the standard exceptions provided by the runtime and the conditions under which you should create a derived class.

| Exception type | Base type | Description | Example |
| -------------- | --------- | ----------- | ------- |
| [Exception](exception-class-properties.md) | [Object](https://msdn.microsoft.com/en-us/library/system.object) | Base class for all exceptions. | None (use a derived class of this exception). |
| [IndexOutOfRangeException](https://msdn.microsoft.com/en-us/library/system.indexoutofrangeexception) | [Exception](https://msdn.microsoft.com/en-us/library/system.exception) | Thrown by the runtime only when an array is indexed improperly. | Indexing an array outside its valid range: `arr[arr.Length+1]` |
| [NullReferenceException](https://msdn.microsoft.com/en-us/library/system.nullreferenceexception) | [Exception](https://msdn.microsoft.com/en-us/library/system.exception) | Thrown by the runtime only when a null object is referenced. | `object o = null; o.ToString();` |
| [AccessViolationException](https://msdn.microsoft.com/en-us/library/system.accessviolationexception) | [Exception](https://msdn.microsoft.com/en-us/library/system.exception) | Thrown by the runtime only when invalid memory is accessed. | Occurs when interoperating with unmanaged code or unsafe managed code, and an invalid pointer is used. |
| [InvalidOperationException](https://msdn.microsoft.com/en-us/library/system.invalidoperationexception) | [Exception](https://msdn.microsoft.com/en-us/library/system.exception) | Thrown by methods when in an invalid state. | Calling `Enumerator.GetNext()` after removing an Item from the underlying collection. |
| [ArgumentException](https://msdn.microsoft.com/en-us/library/system.argumentexception) | [Exception](https://msdn.microsoft.com/en-us/library/system.exception) | Base class for all argument exceptions. | None (use a derived class of this exception). |
| [ArgumentNullException](https://msdn.microsoft.com/en-us/library/system.argumentnullexception) | [ArgumentException](https://msdn.microsoft.com/en-us/library/system.argumentexception) | Thrown by methods that do not allow an argument to be null. | `String s = null; "Calculate".IndexOf (s);` |
| [ArgumentOutOfRangeException](https://msdn.microsoft.com/en-us/library/system.argumentoutofrangeexception) | [ArgumentException](https://msdn.microsoft.com/en-us/library/system.argumentexception) | Thrown by methods that verify that arguments are in a given range. | `String s = "string"; s.Chars[9];` |
| [COMException](https://msdn.microsoft.com/en-us/library/system.runtime.interopservices.comexception) | [Exception](https://msdn.microsoft.com/en-us/library/system.runtime.interopservices.exception) | Exception encapsulating COM HRESULT information. | Used in COM interop. |
| [SEHException](https://msdn.microsoft.com/en-us/library/system.runtime.interopservices.sehexception) | [Exception](https://msdn.microsoft.com/en-us/library/system.runtime.interopservices.exception) | Exception encapsulating Win32 structured exception handling information. | Used in unmanaged code interop. |
